<h2>Random Kata</h2>

<div class="loading" *ngIf="!randomKata">...loading...</div>

<div *ngIf="randomKata">
  <h4 class="capitalize">Name: {{randomKata.name}}</h4>
  <p>Description: {{randomKata.description}}</p>
  <div *ngFor="let test of randomKata.tests">
    <p>Tests: {{randomKata.functionName}}(
      <span *ngFor="let param of test.params">
        <span>{{param}}</span>
      </span>
      )
    </p>
  </div>

  <form (ngSubmit)="handleSubmit(form, randomKata._id)" #form="ngForm">
    <div ace-editor [(text)]="text" [mode]="'javascript'" [theme]="'twilight'" [options]="options" [readOnly]="false" [autoUpdateContent]="true"
      [durationBeforeCallback]="1000" (textChanged)="onChange($event)" style="min-height: 200px; width:100%; overflow: auto;"></div>
    <div class="field submit">
      <button type="submit">Test</button>
      <button type="submit" (click)="testAndSubmit=true">Submit</button>

      <div *ngIf="!passedTests && feedbackEnabled">
        <div *ngIf="error">
          <div [ngSwitch]="error.code" class="validation">
            <div *ngIf="emptyEditor">
              <p *ngSwitchCase="'unexpected-identifier'">Please type some input! Test could not be submitted</p>
              <p *ngSwitchDefault>An unexpected error occured, please try again</p>
            </div>
            <div *ngIf="!emptyEditor">
              <p *ngSwitchCase="'unexpected-identifier'">Unexpected identifier! Test could not be submitted</p>
              <p *ngSwitchDefault>An unexpected error occured, please try again</p>
            </div>
          </div>
        </div>
        <div *ngIf="!error && feedbackEnabled">
          <p class="validation">Ohh..! You have failed the tests. Keep trying</p>
        </div>
      </div>

      <div *ngIf="passedTests && feedbackEnabled">
        <p class="validation">CONGRATS!! You have passed the tests</p>
        <p style="white-space: pre-wrap">{{inputCode}}</p>
      </div>

    </div>
  </form>


</div>